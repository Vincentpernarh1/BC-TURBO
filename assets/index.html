<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BC Turbo - Stellantis/DHL</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="header">
        <div class="brand">BC TURBO <span class="brand-divider">| Stellantis</span></div>
        <div class="folder-controls">
            <button class="btn-folder" onclick="selectDB()">üìÇ Database Folder: <span id="lbl-db">Not Selected</span></button>
            <button class="btn-folder" onclick="selectResult()">üìÇ Result Folder: <span id="lbl-res">Not Selected</span></button>
        </div>
    </div>

    <!-- <div class="nav-bar" id="nav-bar">
        <div class="nav-item" onclick="switchTab('qme')">1. Aumento de QME</div>
        <div class="nav-item" onclick="switchTab('freq')">2. Redu√ß√£o Frequ√™ncia</div>
        <div class="nav-item" onclick="switchTab('emb')">3. Alt. Embalagem</div>
        <div class="nav-item" onclick="switchTab('veh')">4. Alt. Ve√≠culo</div>
        <div class="nav-item" onclick="switchTab('trip')">5. Alt. fluxo de viagem</div>
        <div class="nav-item" onclick="switchTab('waiting')">6. Redu√ß√£o de Waiting Time</div>
        <div class="nav-item" onclick="switchTab('stack')">7. Mudan√ßa de Empilhamento</div>
        <div class="nav-item active" onclick="switchTab('dash')">8. Dashboard</div>

    </div> -->


     <div class="nav-bar" id="nav-bar">
        <div class="nav-item" onclick="switchTab('qme')">1. QME</div>
        <div class="nav-item" onclick="switchTab('freq')">2. Frequ√™ncia</div>
        <div class="nav-item" onclick="switchTab('emb')">3. Embalagem</div>
        <div class="nav-item" onclick="switchTab('veh')">4. Ve√≠culo</div>
        <div class="nav-item" onclick="switchTab('trip')">5. Fluxo de Viagem</div>
        <div class="nav-item" onclick="switchTab('waiting')">6. Waiting Time</div>
        <div class="nav-item" onclick="switchTab('stack')">7. Empilhamento</div>
        <div class="nav-item active" onclick="switchTab('dash')">8. Dashboard</div>

    </div>

    <div class="container">
        
        <div id="mod-qme" class="module">
            <div class="card">

                <div class="to-bar">
                <button class="btn-back" onclick="switchTab('dash')">‚Üê Voltar ao Dashboard</button>
                <h2 class="section-title">Aumento de QME</h2>
                <h3 class="section-title">Par√¢metros de Simula√ß√£o</h3>
                </div>
               
                <!-- Database Warning Message -->
                <div id="db-warning" class="db-warning">
                    üìÇ <strong>Aten√ß√£o:</strong> Por favor, selecione a pasta <strong>Database Folder</strong> no topo da p√°gina antes de inserir dados.
                </div>
                
                <!-- First Row: Project and Location Info -->
                <div class="input-grid-row1">
                    <div class="form-group">
                        <label>C√≥digo do Projeto</label>
                        <input title="cod_projeto" type="text" id="cod_projeto" placeholder="Ex: PROJ-001" disabled class="disabled-input">
                    </div>
                    <div class="form-group">
                        <label>C√≥digo SAP / IMS</label>
                        <input title="cod_sap" type="text" id="cod_sap" placeholder="Digite o c√≥digo..." disabled class="disabled-input">
                    </div>
                    <div class="form-group">
                        <label>Planta </label>
                        <select title="planta" id="planta" disabled class="disabled-input">
                            <option>Betim</option>
                            <option>Porto Real</option>
                            <option>Goiana</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Cidade Origem</label>
                        <input title="origem" type="text" id="origem" disabled class="disabled-input">
                    </div>
                    <div class="form-group">
                        <label>Cidade Destino</label>
                        <input title="destino" type="text" id="destino" disabled class="disabled-input">
                    </div>
                </div>

                <!-- Second Row: Auto-populated Fields -->
                <div class="input-grid-row2">
                    <div class="form-group">
                        <label>Fornecedor <span class="label-grey">(Auto)</span></label>
                        <input title="fornecedor" type="text" id="fornecedor" class="input-readonly" readonly>
                    </div>
                    <div class="form-group">
                        <label>UF <span class="label-grey">(Auto)</span></label>
                        <input title="uf" type="text" id="uf" class="input-readonly" readonly>
                    </div>
                    <div class="form-group">
                        <label>Transportadora <span class="label-grey">(Auto)</span></label>
                        <select title="transportadora" id="transportadora" class="input-readonly" disabled>
                            <option value="">Selecione...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Ve√≠culo Atual <span class="label-grey">(Auto)</span></label>
                        <select title="veiculo" id="veiculo" class="input-readonly" disabled>
                            <option value="">Selecione...</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Fluxo <span class="label-grey">(Auto)</span></label>
                        <select title="fluxo" id="fluxo" class="input-readonly" disabled>
                            <option value="">Selecione...</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Trip <span class="label-grey">(Auto)</span></label>
                        <select title="trip" id="trip" class="input-readonly" disabled>
                            <option value="">Selecione...</option>
                        </select>
                    </div>
                </div>

                <div class="input-grid">
                        <div class="comparison-box-inner">
                            <div class="form-group comparison-left">
                                <label class="label-grey">üìä Dados de Simula√ß√£o</label>
                                <p class="help-text">Importe arquivo com AS IS e TO BE:</p>
                                
                                <div class="flex-center">
                                    <button class="btn-folder btn-folder-full" onclick="importASIS()">
                                        üìÑ Carregar Arquivo (Excel/CSV)
                                    </button>
                                </div>
                                
                                <div class="mt-20">
                                    <label class="label-red">üöÄ Par√¢metros Adicionais</label>
                                    <p class="help-text">Ajustes personalizados (opcional):</p>
                                    <div>
                                        <label>QME Padr√£o TO BE (se n√£o especificado no arquivo)</label>
                                        <input type="number" id="qme_tobe" placeholder="Ex: 150" class="input-tobe">
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="label-grey">üìã Status do Arquivo</label>
                                <p class="help-text">Informa√ß√µes sobre o arquivo importado:</p>
                                <div id="asis-status" class="asis-status-container" >
                            <div class="asis-column as-is">
                                <h4>AS IS</h4>
                                <div id="asis-details" class="asis-details"></div>
                            </div>
                            <div class="asis-column to-be">
                                <h4>TO BE</h4>
                                <div id="tobe-details" class="asis-details"></div>
                            </div>
                        </div>
                        <div id="asis-file-info" class="asis-file-info" ></div>
                        <div id="asis-sample" class="asis-sample" ></div>
                            </div>
                        </div>

                        

                    </div>

                </div>

                <button class="submit-btn" onclick="runSimulation()">Executar Simula√ß√£o</button>
                <div class="clearfix"></div>
            </div>
        </div>

        <div id="mod-freq" class="module">
            <div class="card">
              
                 <div class="to-bar">
                <button class="btn-back" onclick="switchTab('dash')">‚Üê Voltar ao Dashboard</button>
                <h2 class="section-title">Redu√ß√£o de Frequ√™ncia</h2>
                <h3 class="section-title">Par√¢metros de Simula√ß√£o</h3>
                </div>
               
                
                <div class="input-grid">
                    <div class="form-group">
                        <label>C√≥digo do Projeto</label>
                        <input title="freq-cod_projeto" type="text" id="freq-cod_projeto" placeholder="Ex: PROJ-001">
                    </div>
                    <div class="form-group">
                        <label>C√≥digo SAP / IMS</label>
                        <input title="freq-cod_sap" type="text" id="freq-cod_sap" onchange="lookupSAPData()">
                    </div>
                    <div class="form-group">
                        <label>Planta </label>
                        <select title="freq-planta" id="freq-planta">
                            <option>Betim</option>
                            <option>Porto Real</option>
                            <option>Goiana</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Cidade Origem</label>
                        <input title="freq-origem" type="text" id="freq-origem">
                    </div>
                    <div class="form-group">
                        <label>Cidade Destino</label>
                        <input title="freq-destino" type="text" id="freq-destino">
                    </div>

                    <div class="form-group">
                        <label>Fornecedor <span class="label-grey">(Auto)</span></label>
                        <input title="freq-fornecedor" type="text" id="freq-fornecedor" class="input-readonly" readonly>
                    </div>
                    <div class="form-group">
                        <label>UF <span class="label-grey">(Auto)</span></label>
                        <input title="freq-uf" type="text" id="freq-uf" class="input-readonly" readonly>
                    </div>
                    <div class="form-group">
                        <label>Transportadora <span class="label-grey">(Auto)</span></label>
                        <input title="freq-transportadora" type="text" id="freq-transportadora" class="input-readonly" readonly>
                    </div>
                    <div class="form-group">
                        <label>Ve√≠culo Atual <span class="label-grey">(Auto)</span></label>
                        <input title="freq-veiculo" type="text" id="freq-veiculo" class="input-readonly" readonly>
                    </div>

                   <div class="comparison-box">
                        <div class="comparison-box-inner">
                            <div class="form-group comparison-left">
                                <label class="label-grey">üìä Dados de Simula√ß√£o</label>
                                <p class="help-text">Importe arquivo com AS IS e TO BE:</p>
                                
                                <div class="flex-center">
                                    <button class="btn-folder btn-folder-full" onclick="importASIS()">
                                        üìÑ Carregar Arquivo (Excel/CSV)
                                    </button>
                                </div>
                                
                                <div class="mt-20">
                                    <label class="label-red">üöÄ Par√¢metros Adicionais</label>
                                    <p class="help-text">Ajustes personalizados (opcional):</p>
                                    <div>
                                        <label>QME Padr√£o TO BE (se n√£o especificado no arquivo)</label>
                                        <input type="number" id="freq-qme_tobe" placeholder="Ex: 150" class="input-tobe">
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="label-grey">üìã Status do Arquivo</label>
                                <p class="help-text">Informa√ß√µes sobre o arquivo importado:</p>
                                <div id="freq-asis-status" class="asis-status-container" >
                            <div class="asis-column as-is">
                                <h4>AS IS</h4>
                                <div id="freq-asis-details" class="asis-details"></div>
                            </div>
                            <div class="asis-column to-be">
                                <h4>TO BE</h4>
                                <div id="freq-tobe-details" class="asis-details"></div>
                            </div>
                        </div>
                        <div id="freq-asis-file-info" class="asis-file-info" ></div>
                        <div id="freq-asis-sample" class="asis-sample" ></div>
                            </div>
                        </div>

                        

                    </div>

                </div>

                <button class="submit-btn" onclick="runSimulation()">Executar Simula√ß√£o</button>
                <div class="clearfix"></div>






                <p>M√≥dulo em desenvolvimento...</p>
            </div>
        </div>

        <div id="mod-emb" class="module">
            <div class="card">
                <button class="btn-back" onclick="switchTab('dash')">‚Üê Voltar ao Dashboard</button>
                <h3 class="section-title">Altera√ß√£o de Embalagem</h3>
                <p>M√≥dulo em desenvolvimento...</p>
            </div>
        </div>

        <div id="mod-dash" class="module active">
            <div class="card">
                <!-- <h3 class="section-title">Dashboard - Resultados Consolidados</h3> -->
                
                <div id="dashboard-content">
                    <p class="dashboard-placeholder" id="dashboard-placeholder">
                        Execute simula√ß√µes nos m√≥dulos anteriores para ver os resultados consolidados aqui.
                    </p>
                    
                    <!-- Simulation Results Section -->
                    <div id="dashboard-results-section" >
                        <h3 class="section-title">Resultados da Simula√ß√£o</h3>
                        
                        <!-- Summary Cards -->
                        <div class="results-summary">
                            <div class="summary-grid">
                                <div>
                                    <strong>Total de Linhas (Astobe):</strong>
                                    <span id="dashboard-summary-rows" class="summary-value summary-value-red">0</span>
                                </div>
                                <div>
                                    <strong>Linhas com Match (PFEP):</strong>
                                    <span id="dashboard-matched-pns" class="summary-value summary-value-green">0</span>
                                </div>
                                <div>
                                    <strong>PNs sem Match:</strong>
                                    <span id="dashboard-unmatched-pns" class="summary-value summary-value-red">0</span>
                                </div>
                                <div>
                                    <strong>Economia 12 Meses:</strong>
                                    <span id="dashboard-summary-savings" class="summary-value summary-value-green">R$ 0</span>
                                </div>
                            </div>
                        </div>

                        <!-- Detailed Breakdown Section (Combined AS IS / TO BE) -->
                        <div class="table-wrapper monthly-table-wrapper">
                            <h4 class="section-header">üìã Breakdown Detalhado - Comparativo AS IS vs TO BE</h4>
                            <table id="breakdown-combined-table" class="monthly-table breakdown-combined">
                                <thead>
                                    <tr class="month-header-row">
                                        <th class="th-left" rowspan="2">M√©trica</th>
                                        <th class="th-center-month" colspan="2">Jan</th>
                                        <th class="th-center-month" colspan="2">Fev</th>
                                        <th class="th-center-month" colspan="2">Mar</th>
                                        <th class="th-center-month" colspan="2">Abr</th>
                                        <th class="th-center-month" colspan="2">Mai</th>
                                        <th class="th-center-month" colspan="2">Jun</th>
                                        <th class="th-center-month" colspan="2">Jul</th>
                                        <th class="th-center-month" colspan="2">Ago</th>
                                        <th class="th-center-month" colspan="2">Set</th>
                                        <th class="th-center-month" colspan="2">Out</th>
                                        <th class="th-center-month" colspan="2">Nov</th>
                                        <th class="th-center-month" colspan="2">Dez</th>
                                        <th class="th-center th-total-anual" colspan="2" rowspan="2">Total Anual</th>
                                    </tr>
                                    <tr class="scenario-header-row">
                                        <th class="th-scenario-as">AS IS</th>
                                        <th class="th-scenario-to">TO BE</th>
                                        <th class="th-scenario-as">AS IS</th>
                                        <th class="th-scenario-to">TO BE</th>
                                        <th class="th-scenario-as">AS IS</th>
                                        <th class="th-scenario-to">TO BE</th>
                                        <th class="th-scenario-as">AS IS</th>
                                        <th class="th-scenario-to">TO BE</th>
                                        <th class="th-scenario-as">AS IS</th>
                                        <th class="th-scenario-to">TO BE</th>
                                        <th class="th-scenario-as">AS IS</th>
                                        <th class="th-scenario-to">TO BE</th>
                                        <th class="th-scenario-as">AS IS</th>
                                        <th class="th-scenario-to">TO BE</th>
                                        <th class="th-scenario-as">AS IS</th>
                                        <th class="th-scenario-to">TO BE</th>
                                        <th class="th-scenario-as">AS IS</th>
                                        <th class="th-scenario-to">TO BE</th>
                                        <th class="th-scenario-as">AS IS</th>
                                        <th class="th-scenario-to">TO BE</th>
                                        <th class="th-scenario-as">AS IS</th>
                                        <th class="th-scenario-to">TO BE</th>
                                        <th class="th-scenario-as">AS IS</th>
                                        <th class="th-scenario-to">TO BE</th>
                                    </tr>
                                </thead>
                                <tbody id="breakdown-combined-body">
                                    <!-- Combined breakdown will be inserted here -->
                                </tbody>
                            </table>
                        </div>

                        <!-- Aggregated Monthly Table (Summary) -->
                        <div class="table-wrapper monthly-table-wrapper">
                            <h4 class="section-header">üìà Resumo - Comparativo</h4>
                            <table id="dashboard-monthly-table" class="monthly-table">
                                <thead>
                                    <tr>
                                        <th class="th-left">Cen√°rio</th>
                                        <th class="th-center">Jan</th>
                                        <th class="th-center">Fev</th>
                                        <th class="th-center">Mar</th>
                                        <th class="th-center">Abr</th>
                                        <th class="th-center">Mai</th>
                                        <th class="th-center">Jun</th>
                                        <th class="th-center">Jul</th>
                                        <th class="th-center">Ago</th>
                                        <th class="th-center">Set</th>
                                        <th class="th-center">Out</th>
                                        <th class="th-center">Nov</th>
                                        <th class="th-center">Dez</th>
                                        <th class="th-center th-total-anual">Total Anual</th>
                                    </tr>
                                </thead>
                                <tbody id="dashboard-monthly-body">
                                    <!-- Monthly aggregations will be inserted here -->
                                </tbody>
                            </table>
                        </div>

                        <!-- Toggle Button for Detailed View -->
                        <div class="toggle-button-container">
                            <button class="submit-btn" onclick="toggleDetailedView()" id="toggle-details-btn">
                                üîΩ Mostrar Detalhes por PN
                            </button>
                        </div>
                        
                        <!-- Detailed Results Table (Initially Hidden) -->
                        <div id="detailed-results-section" class="hidden-section">
                            <h4 class="section-header">üìä Detalhes por PN</h4>
                            
                            <!-- Legend Box -->
                            <div class="legend-box">
                                <strong class="legend-title">üìå Legenda:</strong>
                                <div class="legend-items">
                                    <div class="legend-item">
                                        <div class="legend-color-matched"></div>
                                        <span>PN Found in PFEP (AS IS data available)</span>
                                    </div>
                                    <div class="legend-item">
                                        <div class="legend-color-unmatched"></div>
                                        <span>PN NOT Found in PFEP (no AS IS data)</span>
                                    </div>
                                </div>
                                <div class="legend-note">
                                    üí° <em>AS IS data (QME, MDR) comes from PFEP database. TO BE data comes from propose file.</em>
                                </div>
                            </div>
                            
                            <div class="table-wrapper">
                                <table id="dashboard-results-table">
                                    <thead>
                                        <tr>
                                            <th class="th-left">Linha</th>
                                            <th class="th-left">PN</th>
                                            <th class="th-center">Jan</th>
                                            <th class="th-center">Fev</th>
                                            <th class="th-center">Mar</th>
                                            <th class="th-center">Abr</th>
                                            <th class="th-center">Mai</th>
                                            <th class="th-center">Jun</th>
                                            <th class="th-center">Jul</th>
                                            <th class="th-center">Ago</th>
                                            <th class="th-center">Set</th>
                                            <th class="th-center">Out</th>
                                            <th class="th-center">Nov</th>
                                            <th class="th-center">Dez</th>
                                            <th class="th-center">QME AS IS</th>
                                            <th class="th-center">MDR AS IS</th>
                                            <th class="th-center">Vol AS IS (m¬≥)</th>
                                            <th class="th-center">Peso AS IS (kg)</th>
                                            <th class="th-center">QME TO BE</th>
                                            <th class="th-center">MDR TO BE</th>
                                            <th class="th-center">Vol TO BE (m¬≥)</th>
                                            <th class="th-center">Peso TO BE (kg)</th>
                                            <th class="th-center">Economia</th>
                                            <th class="th-center">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody id="dashboard-results-body">
                                        <!-- Results will be inserted here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <button class="submit-btn submit-btn-spacing" onclick="exportResults()">
                            üìä Exportar Resultados
                        </button>
                        <div class="clearfix"></div>
                    </div>
                    
                    <!-- Dashboard charts and summary will be added here -->
                    <div title="dashboard-summary" id="dashboard-summary" class="hidden">
                        <div class="results-summary">
                            <h4>Resumo Geral de Simula√ß√µes</h4>
                            <div class="summary-grid">
                                <div>
                                    <strong>Total de Projetos:</strong>
                                    <span id="dash-projects" class="summary-value summary-value-red">0</span>
                                </div>
                                <div>
                                    <strong>Economia Total Anual:</strong>
                                    <span id="dash-savings" class="summary-value summary-value-green">R$ 0</span>
                                </div>
                                <div>
                                    <strong>Redu√ß√£o de Viagens:</strong>
                                    <span id="dash-trips" class="summary-value summary-value-red">0</span>
                                </div>
                                <div>
                                    <strong>CO‚ÇÇ Reduzido:</strong>
                                    <span id="dash-co2" class="summary-value summary-value-green">0 kg</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Toast Notification Overlay -->
    <div id="toast-overlay" class="toast-overlay">
        <div id="toast-message" class="toast-message"></div>
    </div>

<script src="script.js"></script>
</body>
</html>